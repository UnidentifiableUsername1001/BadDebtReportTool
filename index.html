<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bad Debt Report Tool</title>
    
    <!-- PapaParse for parsing CSV files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Google Fonts: Lato (Matches the reference image style) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="BadDebtReport.css">

</head>
<body>

    <!-- BRAND HEADER -->
    <header class="brand-header">
        <div class="header-content">
            <div class="header-title">
                <h1>Bad Debt Report Tool</h1>
                <p class="header-subtitle"></p>
            </div>
            <!-- LOGO PLACEHOLDER -->
            <!-- Update the 'src' below to your actual logo file path -->
            <img src="FC Logo 1(v2).png" alt="Company Logo" class="brand-logo" onerror="this.style.display='none'"> 
        </div>
    </header>

    <div class="container">
        
        <!-- File Upload Section -->
        <div class="card">
            <h2 class="card-title">Data Upload</h2>
            <div class="grid-3">
                <!-- Sheet 1 -->
                <div>
                    <label for="sheet1">All Loans Report</label>
                    <input type="file" id="sheet1" accept=".csv">
                </div>
                <!-- Sheet 2 -->
                <div>
                    <label for="sheet2">Confidential Report</label>
                    <input type="file" id="sheet2" accept=".csv">
                </div>
                <!-- Sheet 3 -->
                <div>
                    <label for="sheet3">Recovery Report</label>
                    <input type="file" id="sheet3" accept=".csv">
                </div>
            </div>
            <div class="text-center mt-4">
                <button id="generate-report-btn" class="btn-primary">
                    Generate Report
                </button>
            </div>
            <div id="error-message"></div>
            <div id="loader" class="loader hidden"></div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="hidden">
            <!-- Summary Cards -->
            <div class="grid-2 mb-4">
                <div class="stat-box">
                    <h3 class="stat-label">Open Cases</h3>
                    <p id="defaulted-cases-count" class="stat-value">0</p>
                </div>
                <div class="stat-box">
                    <h3 class="stat-label">Total Outstanding (Open Cases)</h3>
                    <p id="total-outstanding-balance" class="stat-value">Â£0.00</p>
                </div>
            </div>

            <!-- Detailed Report Table -->
            <div class="card">
                 <h2 class="card-title">Detailed Report</h2>
                <div class="table-container">
                    <table id="report-table">
                        <thead>
                            <!-- Headers will be injected here by JavaScript -->
                        </thead>
                        <tbody>
                            <!-- Rows will be injected here by JavaScript -->
                        </tbody>
                        <tfoot>
                            <!-- Totals will be injected here by JavaScript -->
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="BadDebtReport.js"></script>

</body>
</html>